# 회원 서비스

## 회원 서비스 소개
* 회원 정보관리를 담당하는 서비스 입니다.
* Member 엔티티와 inteliigent_taxi_user DB가 회원 서비스에 속해있습니다.

## 회원관리 기술
* 서버의 성능을 중요시 하는 전체적인 정책때문에 회원 관리 또한 세션처럼 서버에서 부담을 주는 방식이 아닌,
* Jwt 토큰을 활용해 stateless 하게 서버에 부담을 주지 않는 방식을 채택하였습니다.
* 토큰관리는 가장 보편적인 방식인 프론트엔드의 로컬스토리지에서 jwt토큰을 관리하는것을 전제로 합니다.
* 토큰의 만료시간은 2시간입니다.

## 상세 요구사항
* 회원은 일반회원(MEMBER)과 택시(TAXI)회원으로 나누어진다.
* 모든 회원은 uuid기반인 username으로 식별한다.
* username은 uuid + 문자4개의 형태이다. uuid의 중복을 완전히 없애기 위해 뒤에 문자를 붙였다.
* jwt에는 회원의 권한(role)과 username(식별자)가 있다.
* 회원가입시 이메일/비밀번호와 함께 실명도 입력받는다.
* 회원은 이메일과 비밀번호의 변경이 가능해야한다.
* 회원은 마이페이지에서 내 정보를 볼 수 있다.
* 회원은 탈퇴가 가능하다.

카프카 사용
신고 서비스와 통신함

auth와
state가 있음

auth는 member, taxi가 있고

state는 WORK, BLOCK 이 있음

누적 신고 필드가 존재하며 10개일 경우 block처리
report 서비스에서 kafka로 누적신고 증가 요청
이때 누적필드 증가 한 후의 결과가 10개로 예상될때(9개인데 누적 신고 증가 요청 시) block으로 state 변경

배차 서비스에서는 사용자의 state와 auth를 요청하는 것이 가능함
정지가 되면 배차 서비스 이용 불가능

6개월 이상 된 report는 배치로 삭제됨
이때 사용자가 직접 갱신 처리를 해야만 계정의 정지가 풀림
계정 정지를 풀어주는 api를 제공
계정 정지를 푸는 조건을 검증하는 것은 report 서비스가 해야함